;/*FB_PKG_DELIM*/

__d("LSIssueAttachmentsRangeQuery",["LSGetCursor","LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(a){return c.storedProcedure(b("LSGetCursor"),c.i64.cast([0,1])).then(function(a){return a=a,d[0]=a[0],a})},function(e){return c.db.table(17).fetch([[[a[0],a[1]]]]).next().then(function(e,f){var g=e.done;e=e.value;return g?c.sequence([function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[2]=c.i64.cast([0,1]):(e=b.item,d[7]=e.syncGroup,c.i64.neq(d[7],void 0)?d[6]=d[7]:d[6]=c.i64.cast([0,1]),d[2]=d[6])})},function(e){return d[4]=new c.Map(),d[4].set("thread_key",a[0]),d[4].set("media_group",a[1]),d[4].set("max_timestamp_ms",c.i64.cast([2328,1316134911])),d[4].set("cursor",d[0]),d[4].set("sync_group",d[2]),d[4].set("last_loaded_message_id",void 0),d[5]=c.toJSON(d[4]),c.storedProcedure(b("LSIssueNewTask"),"arq",c.i64.cast([0,105]),d[5],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}]):(f=e.item,f.hasMoreBefore?c.sequence([function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[2]=c.i64.cast([0,1]):(e=b.item,d[7]=e.syncGroup,c.i64.neq(d[7],void 0)?d[6]=d[7]:d[6]=c.i64.cast([0,1]),d[2]=d[6])})},function(e){return d[4]=new c.Map(),d[4].set("thread_key",a[0]),d[4].set("media_group",a[1]),d[4].set("max_timestamp_ms",f.minTimestampMs),d[4].set("cursor",d[0]),d[4].set("sync_group",d[2]),d[4].set("last_loaded_message_id",void 0),d[5]=c.toJSON(d[4]),c.storedProcedure(b("LSIssueNewTask"),"arq",c.i64.cast([0,105]),d[5],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}]):c.resolve())})}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSIssueAttachmentsRangeQueryStoredProcedure",["LSIssueAttachmentsRangeQuery","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.threadKey;d[1]=b.mediaGroup;return c("LSIssueAttachmentsRangeQuery").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("MDSShareSvgIcon.react",["MDSSvgIcon.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){return i.jsxs(c("MDSSvgIcon.react"),babelHelpers["extends"]({},a,{children:[i.jsx("path",{d:"M18.766 4.857a1 1 0 00-1.532 0L13.878 8.86a1 1 0 00.766 1.643H16.5a.25.25 0 01.25.25v10.75a1 1 0 001 1h.5a1 1 0 001-1v-10.75a.25.25 0 01.25-.25h1.856a1 1 0 00.766-1.643l-3.356-4.002z"}),i.jsx("path",{d:"M14.75 13.502a1 1 0 00-1-1H12.5a4 4 0 00-4 4v8.5a4 4 0 004 4h11a4 4 0 004-4v-8.5a4 4 0 00-4-4h-1.25a1 1 0 00-1 1v.5a1 1 0 001 1h1.25a1.5 1.5 0 011.5 1.5v8.5a1.5 1.5 0 01-1.5 1.5h-11a1.5 1.5 0 01-1.5-1.5v-8.5a1.5 1.5 0 011.5-1.5h1.25a1 1 0 001-1v-.5z"})]}))}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatAttachmentMediaState.react",["$InternalEnum","I64","LSIntEnum","MessagingAttachmentType","RavenMessagingState","ReQL","ReQLSuspense","filterNulls","gkx","react","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=i||(i=d("react"));e=i;var m=e.createContext,n=e.useCallback,o=e.useEffect,p=e.useMemo,q=e.useState,r=b("$InternalEnum")({Image:0,Video:1}),s=m({canMoveBackward:!1,canMoveForward:!1,card:void 0,cards:[],currentIndex:0,moveBackward:function(){},moveForward:function(){},moveTo:function(){},numberOfCards:0});function t(a){var b=a.attachmentType;a=a.ephemeralMediaState;return a!=null&&(j||(j=d("I64"))).equal(b,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").EPHEMERAL_IMAGE))&&(j||(j=d("I64"))).equal(a,(k||(k=d("LSIntEnum"))).ofNumber(c("RavenMessagingState").PERMANENT))}function u(a){var b=a.attachmentType;a=a.ephemeralMediaState;return a!=null&&(j||(j=d("I64"))).equal(b,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").EPHEMERAL_VIDEO))&&(j||(j=d("I64"))).equal(a,(k||(k=d("LSIntEnum"))).ofNumber(c("RavenMessagingState").PERMANENT))}function v(a,b,c,d){return c?d.hasMedia:b(d,"isPlayableMedia")!=null&&a(d,"isPlayableMedia")!=null}function w(a,b,e,f){var g=f.attachmentType;return!v(a,b,e,f)?!1:t(f)||(j||(j=d("I64"))).equal(g,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))}function x(a,b,e,f){var g=f.attachmentType;return!v(a,b,e,f)?!1:u(f)||(j||(j=d("I64"))).equal(g,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))}function y(a,b){o(function(){a.forEach(function(a){try{c("gkx")("1445")?a.attachment.hasMedia&&b(a.attachment,"usePreloadThumbnails"):b(a.attachment,"usePreloadThumbnails");return}catch(a){return}})},[a,b])}function z(a){var b=a.attachments,d=a.children,e=a.getIsSecureThread,f=a.getPlayableUrl,g=a.getPreviewUrl;a=a.initialAttachment;a=q(a);var h=a[0],i=a[1],j=p(function(){return c("filterNulls")(b.map(function(a){var b=e(a);if(w(f,g,b,a))return{attachment:a,type:r.Image};return x(f,g,b,a)?{attachment:a,type:r.Video}:null}))},[b,e,f,g]),k=h==null?-1:j.findIndex(function(a){return a.attachment.attachmentFbid===h.attachmentFbid&&a.attachment.messageId===h.messageId});y(j,g);a=p(function(){var a=Math.max(0,j.length-1);return{canMoveBackward:k>0&&k!==-1,canMoveForward:k<a&&k!==-1,card:j[k],cards:j,currentIndex:k,moveBackward:function(){var a=Math.max(k-1,0);i((a=j[a])==null?void 0:a.attachment)},moveForward:function(){var b=Math.min(k+1,a);i((b=j[b])==null?void 0:b.attachment)},moveTo:function(a){i(a.attachment)},numberOfCards:j.length}},[k,j]);return l.jsx(s.Provider,{value:a,children:d})}z.displayName=z.name+" [from "+f.id+"]";function a(a){var b=a.attachmentFbid,e=a.children,g=a.getPlayableUrl,i=a.getPreviewUrl,k=a.isSecureThread,m=a.threadKey,o=(h||(h=c("useReStore")))();a=d("ReQLSuspense").useFirst(function(){return d("ReQL").fromTableAscending(o.tables.attachments).getKeyRange(m).filter(function(a){return a.attachmentFbid===b})},[o,m,b],f.id+":269");var q=d("ReQLSuspense").useArray(function(){return d("ReQL").fromTableAscending(o.tables.attachments).getKeyRange(m).filter(function(a){return w(g,i,k,a)||x(g,i,k,a)})},[m,o],f.id+":277"),r=p(function(){return q.sort(function(a,b){return(j||(j=d("I64"))).compare(b.timestampMs,a.timestampMs)})},[q]),s=n(function(){return k},[k]);return l.jsx(z,{attachments:r,getIsSecureThread:s,getPlayableUrl:g,getPreviewUrl:i,initialAttachment:a,children:e})}a.displayName=a.name+" [from "+f.id+"]";g.AttachmentMediaType=r;g.context=s;g.MWChatAttachmentMediaStateProviderFromAttachments=z;g.MWChatAttachmentMediaStateProvider=a}),98);
__d("MWChatAttachmentMediaNavigationHotkeys.react",["fbt","CometKeys","MWChatAttachmentMediaState.react","react","useLayerKeyCommands"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;var k=b.useContext,l=b.useMemo,m={key:c("CometKeys").LEFT},n={key:c("CometKeys").RIGHT},o=h._("__JHASH__6tFY25IlnV4__JHASH__"),p=h._("__JHASH__HYvhkJNYo2M__JHASH__");function a(a){a=a.children;var b=k(d("MWChatAttachmentMediaState.react").context),e=b.moveBackward,f=b.moveForward;b=l(function(){return[{command:m,description:o,handler:e},{command:n,description:p,handler:f}]},[f,e,m,n,o,p]);c("useLayerKeyCommands")(b);return j.jsx("div",{children:(b=a)!=null?b:null})}a.displayName=a.name+" [from "+f.id+"]";g.keyLeft=m;g.keyRight=n;g.MWChatAttachmentMediaNavigationHotkeys=a}),226);
__d("MWChatAttachmentMediaThumbnails.react",["CometMediaViewerFilmstrip.react","CometPlaceholder.react","MWChatAttachmentMediaState.react","gkx","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useContext,k=b.useDeferredValue;function l(a,b){var e=b.attachment,f,g="/images/comet/gray.png";if(e.hasMedia===!1)f=g;else{var h;f=(h=a(e,"toFilmstripThumbnail"))!=null?h:g}if(b.type===d("MWChatAttachmentMediaState.react").AttachmentMediaType.Image){return{alt:(h=e.accessibilitySummaryText)!=null?h:"",backgroundColor:void 0,height:0,isUseImageResizing:void 0,mediaType:"image",uri:c("gkx")("1445")?f:(g=a(e,"toFilmstripThumbnail"))!=null?g:"",width:0}}return{height:0,mediaType:"video",thumbnailUri:c("gkx")("1445")?f:(b=a(e,"toFilmstripThumbnail"))!=null?b:"",uri:c("gkx")("1445")?f:(h=a(e,"toFilmstripThumbnail"))!=null?h:"",width:0}}function m(a){var b=a.activeCard,d=a.cards,e=a.getPreviewUrl,f=a.onSetImage;a=d.map(function(a){return l(e,a)});var g=d.findIndex(function(a){var c;return a.attachment.attachmentFbid===(b==null?void 0:(c=b.attachment)==null?void 0:c.attachmentFbid)&&a.attachment.messageId===(b==null?void 0:(c=b.attachment)==null?void 0:c.messageId)});return i.jsx(c("CometMediaViewerFilmstrip.react"),{activeIndex:g,images:a,onSetImage:function(a){return f(d[a])}})}m.displayName=m.name+" [from "+f.id+"]";function a(a){a=a.getPreviewUrl;var b=j(d("MWChatAttachmentMediaState.react").context),e=b.card,f=b.cards;b=b.moveTo;f=k(f);return i.jsx("div",{className:"xdj266r xkrivgy xat24cr x1gryazu x193iq5w x6ikm8r x10wlt62",children:i.jsx(c("CometPlaceholder.react"),{fallback:null,children:i.jsx(m,{activeCard:e,cards:f,getPreviewUrl:a,onSetImage:b})})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatForwardCircleButton.react",["fbt","MDSShareSvgIcon.react","ODS","SVGIcon","TetraCircleButton.react","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=i||d("react");function a(a){a.attachmentID;var b=a.color,e=a.onOpenForwardDialog,f=a.type;return k.jsx(c("TetraCircleButton.react"),{icon:d("SVGIcon").legacySVGIcon(function(){return k.jsx(c("MDSShareSvgIcon.react"),{color:b,size:24})}),label:h._("__JHASH__GvPr2MwluxY__JHASH__"),onPress:function(){(j||(j=d("ODS"))).bumpEntityKey(3185,"mwchat_media_viewer","forward"),e()},size:36,testid:void 0,type:function(){switch(f){case"deemphasized":return"deemphasized";case"normal":return"normal";case"overlay":return"overlay";case"dark_overlay":return"dark-overlay";case"deemphasized_overlay":case"overlay_raised":return"overlay-raised";case"primary_background_overlay":return"primary-background-overlay"}}()})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("MWMediaViewerRenderQpl",["MWMediaRenderQplUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return d("MWMediaRenderQplUtils").useCommonMediaRenderQplForAttachment(a,b,"full_screen_view")}g.useMediaViewerRenderQpl=a}),98);
__d("MWSharedAttachmentsSectionHooks",["I64","LSIntEnum","LSThreadMediaGalleryGroup","MessagingAttachmentType","ReQL","ReQLSuspense","qex","react","usePrevious","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=k||d("react"),m=l.useCallback,n=l.useEffect,o=l.useState;function a(a){var b=a.attachmentsRange,d=a.hasMore,e=a.loadMore,f=a.logLoadMediaCancel,g=a.logLoadMediaSuccess,h=a.media,i=a.skipInitialLoad;a=o(!1);var j=a[0],k=a[1],l=h.length,p=(a=c("usePrevious")(l))!=null?a:0,q=c("usePrevious")(d),r=(h=c("usePrevious")(j))!=null?h:!1;n(function(){b==null&&i!==!0&&(e(),c("qex")._("89")===!0&&k(!0))},[b,e,i]);n(function(){var a=p!==l,f=q===!0&&!d||b==null&&d===!1&&q===!1&&p===l&&c("qex")._("89")===!0;j&&(f||a)?(k(!1),g==null?void 0:g({fetchedMediaCount:l-p,startMediaCount:p})):p===l&&d&&j&&r===!0&&c("qex")._("89")===!0&&(g==null?void 0:g({fetchedMediaCount:l-p,isAlreadyPreloaded:!0,startMediaCount:p}),e())},[l,d,j,p,q,b,e,r,g,f]);a=m(function(){if(!j){e();return k(!0)}},[j,e,k]);h=l>0||!j&&!d;return[j,a,h]}function p(a,b,e,g){g=g===void 0?{}:g;g=g.removeUnsentMessages;var i=g===void 0?!1:g,j=(h||(h=c("useReStore")))();g=u(a,b);b=g.attachmentsRange;var k=g.hasMoreBefore,l=g.minTimestampMs,n=g.query,o=m(function(a){if(!e(a))return null;if(!i)return a;var b=d("ReQLSuspense").first(d("ReQL").fromTableAscending(j.tables.messages.index("messageId")).getKeyRange(a.messageId),f.id+":151");return b==null||b.isUnsent?null:a},[j,e,i]);g=d("ReQLSuspense").useArray(function(){return n.map(o).filter(Boolean)},[j,a,o,l],f.id+":164");return[g,b,l,k]}function q(a){var b=a.attachmentType;a=a.defaultCtaType;return(i||(i=d("I64"))).equal(b,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").XMA))?a==="xma_web_url":!1}function b(a,b){a=p(a,(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").LINKS),q,b);b=a[0];var e=a[1],f=a[2];a=a[3];return[b,j.ofNumber(c("LSThreadMediaGalleryGroup").LINKS),e,f,a]}function r(a){a=a.attachmentType;return(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))||(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))}function e(a,b){a=p(a,(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS),r,b);b=a[0];var e=a[1],f=a[2];a=a[3];return[b,j.ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS),e,f,a]}function s(a){a=a.attachmentType;return(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").FILE))}function t(a,b){a=p(a,(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").FILES_ONLY),s,b);b=a[0];var e=a[1],f=a[2];a=a[3];return[b,j.ofNumber(c("LSThreadMediaGalleryGroup").FILES_ONLY),e,f,a]}function u(a,b){var e,g=(h||(h=c("useReStore")))(),j=d("ReQLSuspense").useFirst(function(){return d("ReQL").fromTableDescending(g.tables.attachments_ranges_v2__generated).getKeyRange(a).filter(function(a){return(i||(i=d("I64"))).equal(a.mediaGroup,b)})},[g,a,b],f.id+":288"),k=j==null?void 0:j.minTimestampMs;e=c("qex")._("89")===!0?j==null?void 0:j.hasMoreBefore:(e=j==null?void 0:j.hasMoreBefore)!=null?e:!1;var l=d("ReQL").fromTableDescending(g.tables.attachments.index("fk_messages")).getKeyRange(a);l=k!=null&&c("qex")._("1113")===!0?l.bounds({gte:d("ReQL").key(k)}):l;return{attachmentsRange:j,hasMoreBefore:e,minTimestampMs:k,query:l}}g.useLoader=a;g.useQueryLinkAttachments=b;g.filterMediaAttachments=r;g.useQueryMediaAttachments=e;g.useQueryFileAttachments=t;g.useAttachmentsQuery=u}),98);
__d("MWV2MediaViewerContext.react",["react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useMemo,k=i.createContext({getDownloadUrl:function(){},getPlayableUrl:function(){},getPreviewUrl:function(){},heroLoggingComponent:function(a){return null},loadMore:function(){},media:[]});function a(a){var b=a.children,c=a.getDownloadUrl,d=a.getPlayableUrl,e=a.getPreviewUrl,f=a.heroLoggingComponent,g=a.loadMore,h=a.media;a=j(function(){return{getDownloadUrl:c,getPlayableUrl:d,getPreviewUrl:e,heroLoggingComponent:f,loadMore:g,media:h}},[c,d,e,f,g,h]);return i.jsx(k.Provider,{value:a,children:b})}a.displayName=a.name+" [from "+f.id+"]";g.context=k;g.MWV2MediaViewerContextProvider=a}),98);
__d("MWV2MediaViewerControls.react",["fbt","ix","Int64Hooks","LSMessagingThreadTypeUtil","MDSRow.react","MDSRowItem.react","MWChatForwardCircleButton.react","MWV2MediaViewerContext.react","MWXTooltip.react","TetraCircleButton.react","fbicon","react","useMWHasForwardAction","useMWV2MessageForwardAction"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k=j||(j=d("react")),l=j.useContext,m=h._("__JHASH__yVgFxyhzJWR__JHASH__");function a(a){var b=a.attachment,e=a.message,f=a.onClose;a=a.thread;var g=l(d("MWV2MediaViewerContext.react").context);g=g.getDownloadUrl(b,"MWV2MediaViewerControls");return k.jsxs(c("MDSRow.react"),{paddingTop:0,spacing:8,children:[g!=null?k.jsx(c("MDSRowItem.react"),{children:k.jsx(c("MWXTooltip.react"),{tooltip:m,children:k.jsx(c("TetraCircleButton.react"),{color:"white",icon:d("fbicon")._(i("1873235"),16),label:m,linkProps:{download:!0,target:"_blank",url:g},size:36,type:"dark-overlay"})})}):null,e!=null?k.jsx(n,{attachment:b,message:e,thread:a}):null,f!=null?k.jsx(c("MDSRowItem.react"),{children:k.jsx(c("TetraCircleButton.react"),{color:"white",icon:d("fbicon")._(i("478232"),16),label:h._("__JHASH__gaxHiFwvIGk__JHASH__"),onPress:f,size:36,type:"dark-overlay"})}):null]})}a.displayName=a.name+" [from "+f.id+"]";function n(a){var b=a.attachment,e=a.message,f=a.thread;a=b==null?void 0:b.attachmentFbid;var g=d("LSMessagingThreadTypeUtil").isArmadilloSecure(f.threadType),i=d("Int64Hooks").useMemoInt64(function(){return f.threadType},[f.threadType]);g=c("useMWV2MessageForwardAction")(g,e,i);i=c("useMWHasForwardAction")(f.threadType,e,b);e=i.shouldShowForwardAction;return a==null||!e?null:k.jsx(c("MDSRowItem.react"),{children:k.jsx(c("MWXTooltip.react"),{tooltip:h._("__JHASH__GvPr2MwluxY__JHASH__"),children:k.jsx(c("MWChatForwardCircleButton.react"),{attachmentID:a,color:"white",onOpenForwardDialog:g,type:"dark_overlay"})})})}n.displayName=n.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("MWV2MediaViewerItemImage.react",["MWV2MediaViewerContext.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useContext,k=b.useEffect,l=b.useRef;function a(a){var b=a.attachment,c=a.mediaRenderQpl;a=j(d("MWV2MediaViewerContext.react").context);var e=a.getPlayableUrl;a=a.heroLoggingComponent;var f=l(null);k(function(){var a;f.current!=null&&((a=f.current)==null?void 0:a.complete)&&c.endSuccess()},[c]);e=e(b,"MediaViewerImage",c);if(e!=null)return i.jsxs(i.Fragment,{children:[a("MWV2MediaViewerImage"),i.jsx("img",{className:"xr1yuqi xkrivgy x4ii5y1 x1gryazu xmz0i5r x193iq5w",onError:function(){c.endFail("load-image-error")},onLoad:function(){c.endSuccess()},ref:f,src:e})]});else{c.endFail("missing-playable-url");return null}}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWV2MediaViewerItemVideo.react",["MWChatVideoPlayer.react","MWV2MediaViewerContext.react","gkx","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useContext;function a(a){var b=a.attachment;a=a.mediaRenderQpl;var e=j(d("MWV2MediaViewerContext.react").context);e=e.getPlayableUrl;e=e(b,"MediaViewerVideo",a);if(e!=null)return i.jsx("div",{className:"x78zum5 x1iyjqo2 xmz0i5r",children:i.jsx(c("MWChatVideoPlayer.react"),{controls:"mwchat",fbid:b.attachmentFbid,hideExpandButton:!c("gkx")("721"),mediaRenderQpl:a,originalHeight:1e3,originalWidth:1e3,sdSrc:e,shouldForcePauseOnClick:!1})});else{a.endFail("missing-playable-url");return null}}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWV2MediaViewerNullState.react",["fbt","CometColumn.react","CometColumnItem.react","TetraNullState.react","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(){return j.jsx(c("CometColumn.react"),{expanding:!0,verticalAlign:"center",children:j.jsx(c("CometColumnItem.react"),{children:j.jsx(c("TetraNullState.react"),{headline:h._("__JHASH__f1n8ff4Nrlh__JHASH__")})})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("MWV2MediaViewerItem.react",["I64","LSIntEnum","MWMediaViewerRenderQpl","MWV2MediaViewerItemImage.react","MWV2MediaViewerItemVideo.react","MWV2MediaViewerNullState.react","MessagingAttachmentType","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=h||d("react");function a(a){var b=a.attachment;a=a.threadType;if(b==null)return k.jsx(c("MWV2MediaViewerNullState.react"),{});var e=b.attachmentType;return!((i||(i=d("I64"))).equal(e,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))||(i||(i=d("I64"))).equal(e,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))||(i||(i=d("I64"))).equal(e,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO)))?k.jsx(c("MWV2MediaViewerNullState.react"),{}):k.jsx(l,{attachment:b,threadType:a})}a.displayName=a.name+" [from "+f.id+"]";function l(a){var b=a.attachment;a=a.threadType;a=d("MWMediaViewerRenderQpl").useMediaViewerRenderQpl(b,a);var e=b.attachmentType;return(i||(i=d("I64"))).equal(e,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))||(i||(i=d("I64"))).equal(e,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))?k.jsx(c("MWV2MediaViewerItemImage.react"),{attachment:b,mediaRenderQpl:a}):(i||(i=d("I64"))).equal(e,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))?k.jsx(c("MWV2MediaViewerItemVideo.react"),{attachment:b,mediaRenderQpl:a}):null}l.displayName=l.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWV2MediaViewerContent.react",["fbt","CometBlurredBackgroundImage.react","CometHideLayerOnEscape.react","CometPlaceholder.react","I64","LSIntEnum","MWChatAttachmentMediaNavigationHotkeys.react","MWChatAttachmentMediaState.react","MWChatAttachmentMediaThumbnails.react","MWChatMediaViewerNavigationTapTarget.react","MWV2MediaViewerContainer.react","MWV2MediaViewerContext.react","MWV2MediaViewerControls.react","MWV2MediaViewerControlsFallback.react","MWV2MediaViewerItem.react","MWXColumn.react","MWXColumnItem.react","MWXRow.react","MWXRowItem.react","MessagingAttachmentType","ReQL","ReQLSuspense","react","useReStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l,m=j||(j=d("react"));b=j;var n=b.useContext,o=b.useEffect,p={mediaRow:{minHeight:"x2lwn1j",$$css:!0}};function q(a){a=a.attachment;var b=n(d("MWV2MediaViewerContext.react").context);b=b.getPreviewUrl;b=b(a,"BlurredBackground");if(b!=null&&a!=null&&!(k||(k=d("I64"))).equal(a.attachmentType,(l||(l=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE)))return m.jsx("div",{className:"x1ey2m1c xds687c xuzhngd x10l6tqk x17qophe x13vifvy",children:m.jsx(c("CometBlurredBackgroundImage.react"),{src:b})});else return null}q.displayName=q.name+" [from "+f.id+"]";function a(a){var b=a.initialAttachment,e=a.onClose,g=a.shouldShowMessengerLogo;a=a.thread;var j=n(d("MWChatAttachmentMediaState.react").context),k=j.canMoveBackward,l=j.canMoveForward,r=j.card,s=j.currentIndex,t=j.moveBackward,u=j.moveForward,v=j.numberOfCards;j=n(d("MWV2MediaViewerContext.react").context);var w=j.getPreviewUrl,x=j.loadMore,y=(i||(i=c("useReStore")))(),z=b==null?void 0:b.threadKey,A=b==null?void 0:b.messageId;j=d("ReQLSuspense").useFirst(function(){return d("ReQL").fromTableDescending(y.tables.attachments).getKeyRange(z,A)},[y,A,z],f.id+":98")!=null;r=r!=null?r.attachment:j?b:void 0;j=(r==null?void 0:r.messageId)!=null?d("ReQLSuspense").first(d("ReQL").fromTableAscending(y.tables.messages.index("messageId")).getKeyRange(r.messageId),f.id+":115"):null;o(function(){s>v-5&&x()},[s,v,x]);b=m.jsx(c("MWV2MediaViewerItem.react"),{attachment:r,threadType:a.threadType});j=m.jsxs(c("MWV2MediaViewerContainer.react"),{actions:m.jsx(c("CometPlaceholder.react"),{fallback:e!=null?m.jsx(c("MWV2MediaViewerControlsFallback.react"),{onClose:e}):null,children:m.jsx(c("MWV2MediaViewerControls.react"),{attachment:r,message:j,onClose:e,thread:a})}),shouldShowMessengerLogo:g,children:[m.jsx(d("MWChatAttachmentMediaNavigationHotkeys.react").MWChatAttachmentMediaNavigationHotkeys,{}),m.jsx(c("CometPlaceholder.react"),{fallback:null,children:m.jsx(q,{attachment:r})}),m.jsxs(c("MWXColumn.react"),{align:"stretch",expanding:!0,paddingHorizontal:0,verticalAlign:"space-between",children:[m.jsx(c("MWXColumnItem.react"),{expanding:!0,verticalAlign:"center",children:m.jsxs(c("MWXRow.react"),{align:"justify",expanding:!0,paddingHorizontal:0,paddingVertical:0,verticalAlign:"stretch",xstyle:p.mediaRow,children:[m.jsx(c("MWXRowItem.react"),{children:m.jsx(c("MWChatMediaViewerNavigationTapTarget.react"),{direction:"previous",disable:!1,invisible:!k,label:h._("__JHASH__LwpPfoJWBJ-__JHASH__"),onClick:t,testid:void 0})}),m.jsx(c("MWXRowItem.react"),{expanding:!0,verticalAlign:"stretch",children:m.jsx(c("CometPlaceholder.react"),{fallback:null,children:b})}),m.jsx(c("MWXRowItem.react"),{children:m.jsx(c("MWChatMediaViewerNavigationTapTarget.react"),{direction:"next",disable:!1,invisible:!l,label:h._("__JHASH__37s-bUHecpV__JHASH__"),onClick:u,testid:void 0})})]})}),m.jsx(c("MWXColumnItem.react"),{children:m.jsx(c("MWChatAttachmentMediaThumbnails.react"),{getPreviewUrl:w})})]})]});if(e!=null)return m.jsx(c("CometHideLayerOnEscape.react"),{onHide:e,children:j});else return j}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("useLoadMoreThreadSharedAttachments.react",["Int64Hooks","LSFactory","LSIssueAttachmentsRangeQueryStoredProcedure","MAWThreadCutover","MWThreadKey.react","promiseDone","qex","useAsyncReStore"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var e=c("useAsyncReStore")(),g=d("MWThreadKey.react").useMWThreadKeyMemoizedExn(),h=d("MAWThreadCutover").useGetCutoverOpenThreadKey(g);return d("Int64Hooks").useCallbackInt64(function(){b==null?void 0:b(),c("promiseDone")(e,function(b){return b.runInTransaction(function(b){return c("LSIssueAttachmentsRangeQueryStoredProcedure")(c("LSFactory")(b),{mediaGroup:a,threadKey:h&&c("qex")._("89")===!0?h:g})},"readwrite",void 0,void 0,f.id+":36")})},[b,e,a,h,g])}g["default"]=a}),98);
__d("useMAWLoadMoreThreadSharedAttachments",["I64","Int64Hooks","MAWBridgeSendAndReceive","MAWMiActOnActThreadReady","promiseDone","qex","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=(i||(i=d("I64"))).of_string("9999999999999");function a(a,b,e,f,g){var k=(h||(h=c("useReStore")))(),l=d("Int64Hooks").useCallbackInt64(function(){return b!=null&&b&&e!=null?c("qex")._("89")===!0?(i||(i=d("I64"))).to_float(e):(i||(i=d("I64"))).to_int32(e):c("qex")._("89")===!0?Number.MAX_SAFE_INTEGER:(i||(i=d("I64"))).to_int32(j)},[b,e]);return d("Int64Hooks").useCallbackInt64(function(){a!=null&&(g==null?void 0:g(),c("promiseDone")(d("MAWMiActOnActThreadReady").onActThreadReady(k.tables,a,"useMAWLoadMoreThreadSharedAttachments",function(a,b){return d("MAWBridgeSendAndReceive").sendAndReceive("backend","loadMoreMedia",{earliestLoadedMediaMessageId:f,earliestLoadedMediaTs:l(),threadJid:b})})))},[a,g,k.tables,f,l])}g["default"]=a}),98);
__d("useMAWQuerySecureMediaAttachments",["I64","LSIntEnum","LSThreadMediaGalleryGroup","MWSharedAttachmentsSectionHooks","ReQL","ReQLSuspense","qex","react","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=(k||d("react")).useCallback;function a(a,b){b=b===void 0?{}:b;b=b.removeUnsentMessages;var e=b===void 0?!1:b,g=(h||(h=c("useReStore")))();b=d("MWSharedAttachmentsSectionHooks").useAttachmentsQuery(a,(i||(i=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS));var j=b.attachmentsRange,k=b.hasMoreBefore,n=b.minTimestampMs,p=b.query,q=l(function(a){if(!d("MWSharedAttachmentsSectionHooks").filterMediaAttachments(a))return null;var b=d("ReQLSuspense").first(d("ReQL").fromTableAscending(g.tables.messages.index("messageId")).getKeyRange(a.messageId),f.id+":73");if(e&&(b==null||b.isUnsent))return null;return c("qex")._("1113")===!0?b==null?{attachment:a}:{attachment:a,message:b}:{attachment:a}},[g,e]);b=d("ReQLSuspense").useArray(function(){return p.map(q).filter(Boolean)},[g,a,q,n],f.id+":95");a=m(b);c("qex")._("1113")===!0&&a.sort(o);b=a.map(function(a){a=a.attachment;return a});return[b,i.ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS),j,n,k]}function m(a){var b=n(a);return a.map(function(a){var c,e=a.attachment;a=a.message;var f=a==null?void 0:a.groupId;c=b.get((c=f)!=null?c:"");if(f==null||c==null){return{attachment:e,message:a,sortKey:{sortingMessageGroupIndex:Number.MAX_SAFE_INTEGER,sortingMessageId:e.messageId,sortingMessagePrimarySortTS:(f=a==null?void 0:a.primarySortKey)!=null?f:e.timestampMs,sortingMessageSecondarySortTS:(f=(f=a==null?void 0:a.secondarySortKey)!=null?f:a==null?void 0:a.timestampMs)!=null?f:e.timestampMs}}}return{attachment:e,message:a,sortKey:{sortingMessageGroupIndex:(j||(j=d("I64"))).to_int32((f=a==null?void 0:a.groupIndex)!=null?f:(j||(j=d("I64"))).zero),sortingMessageId:c.messageId,sortingMessagePrimarySortTS:c.primarySortTs,sortingMessageSecondarySortTS:c.secondarySortTs}}})}function n(a){var b=new Map();a.forEach(function(a){var c;a=a.message;if(!a||a.groupId==null||a.groupIndex==null)return;var e=a.groupId,f=(j||(j=d("I64"))).to_int32(a.groupIndex);c=Math.min((c=(c=b.get(e))==null?void 0:c.groupIndex)!=null?c:Number.MAX_SAFE_INTEGER,f);f=f===c?{groupIndex:f,messageId:a.messageId,primarySortTs:a.primarySortKey,secondarySortTs:(c=a.secondarySortKey)!=null?c:a.timestampMs}:b.get(e);f&&b.set(e,f)});return b}function o(a,b){var c=a.sortKey,e=b.sortKey;a=a.message;b=b.message;if(!(j||(j=d("I64"))).equal(c.sortingMessagePrimarySortTS,e.sortingMessagePrimarySortTS))return(j||(j=d("I64"))).compare(e.sortingMessagePrimarySortTS,c.sortingMessagePrimarySortTS);if(!(j||(j=d("I64"))).equal(e.sortingMessageSecondarySortTS,c.sortingMessageSecondarySortTS))return(j||(j=d("I64"))).compare(e.sortingMessageSecondarySortTS,c.sortingMessageSecondarySortTS);if(c.sortingMessageId!==e.sortingMessageId)return e.sortingMessageId.localeCompare(c.sortingMessageId);return(a==null?void 0:a.groupId)!=null&&(b==null?void 0:b.groupId)!=null&&a.groupId===b.groupId?e.sortingMessageGroupIndex-c.sortingMessageGroupIndex:0}g.useMAWQuerySecureMediaAttachments=a}),98);
__d("useMWMediaLoadingQplLogger",["MWMediaRenderQplUtils","QPLUserFlow","QuickPerformanceLogger","Random","qex","qpl","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i;b=i||d("react");var j=b.useEffect,k=b.useMemo;function a(a){var b=a.entrypoint,d=a.threadType,e=k(function(){return o()},[]);j(function(){return function(){var a=(h||(h=c("QuickPerformanceLogger"))).isMarkerOn(c("qpl")._(25300395,"1954"),e);a&&i()}},[]);var f=function(a){var f;if(!c("qex")._("89")===!0)return;l({entrypoint:b,instanceKey:e,isCutoverThread:(f=a==null?void 0:a.isCutoverThread)!=null?f:!1,isPreCutoverMedia:(f=a==null?void 0:a.isPreCutoverMedia)!=null?f:!1,threadType:d})},g=function(a){var b=a.fetchedMediaCount,d=a.isAlreadyPreloaded;a=a.startMediaCount;if(!c("qex")._("89")===!0)return;m({fetchedMediaCount:b,instanceKey:e,isAlreadyPreloaded:d,startMediaCount:a})},i=function(){if(!c("qex")._("89")===!0)return;n({instanceKey:e})};return k(function(){return{logLoadMediaCancel:i,logLoadMediaStart:f,logLoadMediaSuccess:g}},[])}function l(a){var b=a.entrypoint,e=a.instanceKey,f=a.isCutoverThread;f=f===void 0?!1:f;var g=a.isPreCutoverMedia;g=g===void 0?!1:g;a=a.threadType;c("QPLUserFlow").start(c("qpl")._(25300395,"1954"),{annotations:{bool:{isCutoverThread:f,isPreCutoverMedia:g},string:{entrypoint:b,threadType:d("MWMediaRenderQplUtils").getThreadTypeStringFromEnum(a)}},cancelOnUnload:!0,instanceKey:e,timeoutInMs:60*1e3})}function m(a){var b=a.fetchedMediaCount,d=a.instanceKey,e=a.isAlreadyPreloaded;a=a.startMediaCount;c("QPLUserFlow").endSuccess(c("qpl")._(25300395,"1954"),{annotations:{bool:{isAlreadyPreloaded:(e=e)!=null?e:!1},"int":{fetchedMediaCount:b,startMediaCount:a}},instanceKey:d})}function n(a){a=a.instanceKey;c("QPLUserFlow").endCancel(c("qpl")._(25300395,"1954"),{instanceKey:a})}function o(){return Date.now()+Math.round(d("Random").random()*1e4)}g["default"]=a}),98);
__d("useMAWLoadMoreCutoverThreadSharedAttachments",["MAWDbMsg","MWSharedAttachmentsSectionHooks","react","useLoadMoreThreadSharedAttachments.react","useMAWLoadMoreThreadSharedAttachments","useMAWQuerySecureMediaAttachments","useMWMediaLoadingQplLogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useCallback;function a(a,b,e){var f,g=d("useMAWQuerySecureMediaAttachments").useMAWQuerySecureMediaAttachments(a),h=g[0],j=g[1],k=g[2],l=g[3];g=g[4];f=(f=g)!=null?f:!0;var m=(k==null?void 0:k.lastLoadedMessageId)!=null?d("MAWDbMsg").toMsgId(k==null?void 0:k.lastLoadedMessageId):void 0,n=c("useMWMediaLoadingQplLogger")({entrypoint:e.entrypoint,threadType:e.threadType});e=i(function(){n.logLoadMediaStart({isCutoverThread:!0,isPreCutoverMedia:!1})},[n]);g=c("useMAWLoadMoreThreadSharedAttachments")(a,g,l,(a=m)!=null?a:void 0,e);l=d("MWSharedAttachmentsSectionHooks").useQueryMediaAttachments(b);m=l[0];a=l[2];e=l[4];l=(b=e)!=null?b:!1;e=i(function(){n.logLoadMediaStart({isCutoverThread:!0,isPreCutoverMedia:!0})},[n]);b=c("useLoadMoreThreadSharedAttachments.react")(j,e);j=d("MWSharedAttachmentsSectionHooks").useLoader({attachmentsRange:k,hasMore:f,loadMore:g,logLoadMediaCancel:n.logLoadMediaCancel,logLoadMediaSuccess:n.logLoadMediaSuccess,media:h});e=j[0];k=j[1];g=j[2];j=d("MWSharedAttachmentsSectionHooks").useLoader({attachmentsRange:a,hasMore:l,loadMore:b,logLoadMediaCancel:n.logLoadMediaCancel,logLoadMediaSuccess:n.logLoadMediaSuccess,media:m,skipInitialLoad:f||e});a=j[0];b=j[1];j=j[2];if(f||e)return{attachments:h,completedFirstLoad:g,hasMore:f,isLoadingMore:e,onLoadMore:k};else if(l||a)return{attachments:h.concat(m),completedFirstLoad:j,hasMore:l,isLoadingMore:a,onLoadMore:b};else return{attachments:h.concat(m),completedFirstLoad:!0,hasMore:!1,isLoadingMore:!1,onLoadMore:function(){}}}g["default"]=a}),98);
__d("useMWV2MediaViewerOpenPlayableUrl",["I64","LSIntEnum","LSMediaUrlAttachment","MessagingAttachmentType","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=(h||d("react")).useCallback;function a(){return k(function(a){return a==null?void 0:(i||(i=d("I64"))).equal(a.attachmentType,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))?d("LSMediaUrlAttachment").previewUrl(a):d("LSMediaUrlAttachment").playableUrl(a)},[])}g["default"]=a}),98);
__d("useMWV2MediaViewerOpenDownloadUrl",["gkx","react","useMWV2MediaViewerOpenPlayableUrl"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useCallback;function a(){var a=c("useMWV2MediaViewerOpenPlayableUrl")();return i(function(b,d,e){b=a(b,d,e);if(b==null)return void 0;if(!c("gkx")("3973"))return b;d=new URL(b);d.searchParams.set("dl","1");return d.toString()},[a])}g["default"]=a}),98);
__d("useMWV2MediaViewerOpenPreviewUrl",["LSMediaUrlAttachment","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useCallback;function a(){return i(function(a){return a!=null?d("LSMediaUrlAttachment").previewUrl(a):void 0},[])}g["default"]=a}),98);
__d("useMWV2MediaViewerSecurePlayableUrl",["cr:5970","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useCallback;function a(){return i(function(a,c,d){return(a=b("cr:5970")==null?void 0:b("cr:5970").getAttachmentBlob(a,c,d))!=null?a:""},[])}g["default"]=a}),98);
__d("useMWV2MediaViewerSecurePreviewUrl",["cr:5931","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useCallback;function a(){return i(function(a,c,d){return b("cr:5931")==null?void 0:b("cr:5931")(a,c,d)},[])}g["default"]=a}),98);
__d("MWV2MediaViewerCutoverWrapper.react",["MWChatAttachmentMediaState.react","MWV2MediaViewerContext.react","emptyFunction","react","useMAWLoadMoreCutoverThreadSharedAttachments","useMWV2MediaViewerOpenDownloadUrl","useMWV2MediaViewerOpenPlayableUrl","useMWV2MediaViewerOpenPreviewUrl","useMWV2MediaViewerSecurePlayableUrl","useMWV2MediaViewerSecurePreviewUrl"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useCallback;function a(a){var b=a.children,e=a.initialAttachment,f=a.openThreadKey,g=a.secureThreadKey;a=a.threadType;g=c("useMAWLoadMoreCutoverThreadSharedAttachments")(g,f,{entrypoint:"media_viewer",threadType:a});f=g.attachments;a=g.onLoadMore;var h=j(function(a){return!((a==null?void 0:a.transportKey)==="FBBroker"||(a==null?void 0:a.transportKey)==="FBLegacyBroker")},[]),k=c("useMWV2MediaViewerOpenPreviewUrl")(),l=c("useMWV2MediaViewerOpenPlayableUrl")(),m=c("useMWV2MediaViewerOpenDownloadUrl")(),n=c("useMWV2MediaViewerSecurePreviewUrl")(),o=c("useMWV2MediaViewerSecurePlayableUrl")();g=j(function(a,b,c){if(!a)return"";return!h(a)?k(a,b,c):n(a,b,c)},[h,k,n]);var p=j(function(a,b,c){if(a==null)return"";return!h(a)?l(a,b,c):o(a,b,c)},[h,l,o]),q=j(function(a,b,c){if(a==null)return"";return!h(a)?m(a,b,c):o(a,b,c)},[h,m,o]);return i.jsx(d("MWV2MediaViewerContext.react").MWV2MediaViewerContextProvider,{getDownloadUrl:q,getPlayableUrl:p,getPreviewUrl:g,heroLoggingComponent:c("emptyFunction"),loadMore:a,media:f,children:i.jsx(d("MWChatAttachmentMediaState.react").MWChatAttachmentMediaStateProviderFromAttachments,{attachments:f,getIsSecureThread:h,getPlayableUrl:p,getPreviewUrl:g,initialAttachment:e,children:b})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWV2MediaViewerOpenWrapper.react",["CometHero.react","MWChatAttachmentMediaState.react","MWSharedAttachmentsSectionHooks","MWV2MediaViewerContext.react","react","useLoadMoreThreadSharedAttachments.react","useMWMediaLoadingQplLogger","useMWV2MediaViewerOpenDownloadUrl","useMWV2MediaViewerOpenPlayableUrl","useMWV2MediaViewerOpenPreviewUrl"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useCallback;function a(a){var b=a.children,e=a.initialAttachment;a=a.thread;var f=d("MWSharedAttachmentsSectionHooks").useQueryMediaAttachments(a.threadKey),g=f[0],h=f[1],k=f[2];f[3];f=f[4];a=c("useMWMediaLoadingQplLogger")({entrypoint:"media_viewer",threadType:a.threadType});h=c("useLoadMoreThreadSharedAttachments.react")(h,a.logLoadMediaStart);f=d("MWSharedAttachmentsSectionHooks").useLoader({attachmentsRange:k,hasMore:(k=f)!=null?k:!0,loadMore:h,logLoadMediaCancel:a.logLoadMediaCancel,logLoadMediaSuccess:a.logLoadMediaSuccess,media:g});k=f[1];h=c("useMWV2MediaViewerOpenPreviewUrl")();a=c("useMWV2MediaViewerOpenPlayableUrl")();f=c("useMWV2MediaViewerOpenDownloadUrl")();var l=j(function(){return!1},[]);return i.jsx(d("MWV2MediaViewerContext.react").MWV2MediaViewerContextProvider,{getDownloadUrl:f,getPlayableUrl:a,getPreviewUrl:h,heroLoggingComponent:function(a){return i.jsx(c("CometHero.react"),{description:a})},loadMore:k,media:g,children:i.jsx(d("MWChatAttachmentMediaState.react").MWChatAttachmentMediaStateProviderFromAttachments,{attachments:g,getIsSecureThread:l,getPlayableUrl:a,getPreviewUrl:h,initialAttachment:e,children:b})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWV2MediaViewerSecureWrapper.react",["MAWDbMsg","MWChatAttachmentMediaState.react","MWSharedAttachmentsSectionHooks","MWV2MediaViewerContext.react","MWV2MediaViewerNullState.react","cr:5709","cr:5931","cr:5970","emptyFunction","qex","react","useMAWQuerySecureMediaAttachments","useMWMediaLoadingQplLogger","useMWV2MediaViewerSecurePlayableUrl","useMWV2MediaViewerSecurePreviewUrl"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useCallback;function a(a,b,c,d,e){return function(){}}var k=b("cr:5709")==null?a:b("cr:5709");function e(a){var e=a.children,f=a.initialAttachment;a=a.thread;var g=d("useMAWQuerySecureMediaAttachments").useMAWQuerySecureMediaAttachments(a.threadKey),h=g[0];g[1];var l=g[2],m=g[3];g=g[4];var n=(g=g)!=null?g:!0;g=c("useMWMediaLoadingQplLogger")({entrypoint:"media_viewer",threadType:a.threadType});var o=k(a.threadKey,n,m,c("qex")._("89")===!0?(m=d("MAWDbMsg").toMsgId((a=l==null?void 0:l.lastLoadedMessageId)!=null?a:""))!=null?m:void 0:void 0,g.logLoadMediaStart);a=j(function(){n&&o()},[n,o]);m=d("MWSharedAttachmentsSectionHooks").useLoader({attachmentsRange:l,hasMore:n,loadMore:a,logLoadMediaCancel:g.logLoadMediaCancel,logLoadMediaSuccess:g.logLoadMediaSuccess,media:h});l=m[1];a=c("useMWV2MediaViewerSecurePreviewUrl")();g=c("useMWV2MediaViewerSecurePlayableUrl")();m=j(function(){return!0},[]);return b("cr:5970")==null||b("cr:5931")==null?i.jsx(c("MWV2MediaViewerNullState.react"),{}):i.jsx(d("MWV2MediaViewerContext.react").MWV2MediaViewerContextProvider,{getDownloadUrl:g,getPlayableUrl:g,getPreviewUrl:a,heroLoggingComponent:c("emptyFunction"),loadMore:l,media:h,children:i.jsx(d("MWChatAttachmentMediaState.react").MWChatAttachmentMediaStateProviderFromAttachments,{attachments:h,getIsSecureThread:m,getPlayableUrl:g,getPreviewUrl:a,initialAttachment:f,children:e})})}e.displayName=e.name+" [from "+f.id+"]";g["default"]=e}),98);
__d("MWV2MediaViewer.react",["FBLogger","I64","LSMessagingThreadTypeUtil","MAWThreadCutover","MWLSThread","MWV2MediaViewerContent.react","MWV2MediaViewerCutoverWrapper.react","MWV2MediaViewerNullState.react","MWV2MediaViewerOpenWrapper.react","MWV2MediaViewerSecureWrapper.react","qex","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||d("react");function a(a){var b=a.attachment,e=a.onClose;a=a.shouldShowMessengerLogo;var f=d("MWLSThread").useThread(b.threadKey),g=d("MAWThreadCutover").useGetCutoverOpenThreadKey(b.threadKey),h=d("MAWThreadCutover").useCutoverSecureThreadKeyForOpenThreadKey(g==null?b.threadKey:void 0);if(f==null){c("FBLogger")("messenger_web_media").mustfix("Thread is null in media viewer for attachment with threadKey: %s",(i||(i=d("I64"))).to_string(b.threadKey));return j.jsx(c("MWV2MediaViewerNullState.react"),{})}var k=d("LSMessagingThreadTypeUtil").isArmadilloSecure(f.threadType);if((g!=null||h!=null)&&c("qex")._("89")===!0)return j.jsx(c("MWV2MediaViewerCutoverWrapper.react"),{initialAttachment:b,openThreadKey:g!=null?g:f.threadKey,secureThreadKey:h!=null?h:f.threadKey,threadType:f.threadType,children:j.jsx(c("MWV2MediaViewerContent.react"),{initialAttachment:b,onClose:e,shouldShowMessengerLogo:a,thread:f})});return k?j.jsx(c("MWV2MediaViewerSecureWrapper.react"),{initialAttachment:b,thread:f,children:j.jsx(c("MWV2MediaViewerContent.react"),{initialAttachment:b,onClose:e,shouldShowMessengerLogo:a,thread:f})}):j.jsx(c("MWV2MediaViewerOpenWrapper.react"),{initialAttachment:b,thread:f,children:j.jsx(c("MWV2MediaViewerContent.react"),{initialAttachment:b,onClose:e,shouldShowMessengerLogo:a,thread:f})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);